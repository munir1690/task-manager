<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eisenhower Task Matrix</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom scrollbar for a cleaner look */
        .task-list::-webkit-scrollbar {
            width: 6px;
        }
        .task-list::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        .task-list::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        .task-list::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        /* Style for the date input */
        input[type="date"]::-webkit-calendar-picker-indicator {
            cursor: pointer;
            filter: invert(0.5);
        }
    </style>
</head>
<body class="bg-slate-100 text-slate-800">

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">
        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold text-slate-900">Task Matrix</h1>
            <p class="text-slate-500 mt-2">Organize your tasks using the Eisenhower Matrix.</p>
            <!-- Date Navigation -->
            <div id="date-controls" class="mt-6 flex justify-center items-center gap-4">
                <button id="prev-day" class="p-2 rounded-md bg-white shadow hover:bg-slate-200 transition">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"></polyline></svg>
                </button>
                <input type="date" id="date-picker" class="border border-slate-300 rounded-lg p-2 text-lg bg-white shadow focus:ring-2 focus:ring-blue-500 focus:outline-none">
                <button id="next-day" class="p-2 rounded-md bg-white shadow hover:bg-slate-200 transition">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>
                </button>
            </div>
        </header>

        <!-- Task Input Form -->
        <form id="task-form" class="bg-white p-4 rounded-xl shadow-md mb-8 flex flex-col sm:flex-row items-center gap-4">
            <input type="text" id="task-input" placeholder="Enter a new task..." required class="flex-grow w-full sm:w-auto text-lg p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none transition">
            <select id="quadrant-select" class="w-full sm:w-auto p-3 text-lg border border-slate-300 rounded-lg bg-white focus:ring-2 focus:ring-blue-500 focus:outline-none transition cursor-pointer">
                <option value="iu">Urgent & Important</option>
                <option value="inu">Not Urgent & Important</option>
                <option value="niu">Urgent & Not Important</option>
                <option value="ninu">Not Urgent & Not Important</option>
            </select>
            <button type="submit" class="w-full sm:w-auto bg-blue-600 text-white font-semibold py-3 px-6 rounded-lg hover:bg-blue-700 transition-all shadow hover:shadow-lg transform hover:-translate-y-0.5 flex items-center justify-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                Add Task
            </button>
        </form>

        <!-- Eisenhower Matrix Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Quadrant: Not Urgent & Important -->
            <div id="q-inu" class="bg-white rounded-xl shadow-lg p-5 flex flex-col border-t-4 border-green-500">
                <h2 class="text-xl font-bold text-green-600 mb-1">Not Urgent & Important</h2>
                <p class="text-sm text-slate-500 mb-4">(Schedule)</p>
                <ul class="task-list space-y-3 overflow-y-auto h-64 pr-2"></ul>
            </div>
            
            <!-- Quadrant: Urgent & Important -->
            <div id="q-iu" class="bg-white rounded-xl shadow-lg p-5 flex flex-col border-t-4 border-red-500">
                <h2 class="text-xl font-bold text-red-600 mb-1">Urgent & Important</h2>
                <p class="text-sm text-slate-500 mb-4">(Do First)</p>
                <ul class="task-list space-y-3 overflow-y-auto h-64 pr-2"></ul>
            </div>
            
            <!-- Quadrant: Not Urgent & Not Important -->
            <div id="q-ninu" class="bg-white rounded-xl shadow-lg p-5 flex flex-col border-t-4 border-gray-500">
                <h2 class="text-xl font-bold text-gray-600 mb-1">Not Urgent & Not Important</h2>
                <p class="text-sm text-slate-500 mb-4">(Eliminate)</p>
                <ul class="task-list space-y-3 overflow-y-auto h-64 pr-2"></ul>
            </div>
            
            <!-- Quadrant: Urgent & Not Important -->
            <div id="q-niu" class="bg-white rounded-xl shadow-lg p-5 flex flex-col border-t-4 border-orange-500">
                <h2 class="text-xl font-bold text-orange-600 mb-1">Urgent & Not Important</h2>
                 <p class="text-sm text-slate-500 mb-4">(Delegate)</p>
                <ul class="task-list space-y-3 overflow-y-auto h-64 pr-2"></ul>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const taskForm = document.getElementById('task-form');
            const taskInput = document.getElementById('task-input');
            const quadrantSelect = document.getElementById('quadrant-select');
            const datePicker = document.getElementById('date-picker');
            const prevDayButton = document.getElementById('prev-day');
            const nextDayButton = document.getElementById('next-day');

            const STORAGE_KEY = 'matrixTasks';

            let currentDate = new Date();

            const quadrantLists = {
                'iu': document.querySelector('#q-iu .task-list'),
                'inu': document.querySelector('#q-inu .task-list'),
                'niu': document.querySelector('#q-niu .task-list'),
                'ninu': document.querySelector('#q-ninu .task-list')
            };

            // --- DATE HELPERS ---
            const toYYYYMMDD = (date) => date.toISOString().split('T')[0];

            const updateDate = (offset) => {
                currentDate.setDate(currentDate.getDate() + offset);
                renderForDate(currentDate);
            };
            
            const renderForDate = (date) => {
                datePicker.value = toYYYYMMDD(date);
                loadTasksForDate(toYYYYMMDD(date));
            };

            // --- LOCAL STORAGE ---
            const getTasksFromStorage = () => {
                try {
                    const tasks = localStorage.getItem(STORAGE_KEY);
                    return tasks ? JSON.parse(tasks) : {};
                } catch (e) {
                    console.error("Error parsing tasks from localStorage:", e);
                    return {}; // Return a default empty object on error
                }
            };

            const saveTasksForDate = (dateString) => {
                const allTasks = getTasksFromStorage();
                const tasksForDay = { iu: [], inu: [], niu: [], ninu: [] };

                for (const key in quadrantLists) {
                    const list = quadrantLists[key];
                    list.querySelectorAll('li.task').forEach(taskItem => {
                        tasksForDay[key].push({
                            text: taskItem.querySelector('span').textContent,
                            completed: taskItem.classList.contains('opacity-50')
                        });
                    });
                }
                allTasks[dateString] = tasksForDay;
                localStorage.setItem(STORAGE_KEY, JSON.stringify(allTasks));
            };

            const loadTasksForDate = (dateString) => {
                for (const key in quadrantLists) {
                    quadrantLists[key].innerHTML = '';
                }

                const allTasks = getTasksFromStorage();
                const tasksForDay = allTasks[dateString];

                if (tasksForDay) {
                    for (const quadrantKey in tasksForDay) {
                        tasksForDay[quadrantKey].forEach(task => {
                            addTaskToDOM(task, quadrantKey);
                        });
                    }
                }
            };
            
            // --- EVENT LISTENERS ---
            taskForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const taskText = taskInput.value.trim();
                if (taskText) {
                    const task = { text: taskText, completed: false };
                    const selectedQuadrant = quadrantSelect.value;
                    addTaskToDOM(task, selectedQuadrant);
                    saveTasksForDate(toYYYYMMDD(currentDate));
                    taskInput.value = '';
                    taskInput.focus();
                }
            });

            datePicker.addEventListener('change', () => {
                currentDate = new Date(datePicker.value + 'T00:00:00'); // Adjust for timezone
                renderForDate(currentDate);
            });
            prevDayButton.addEventListener('click', () => updateDate(-1));
            nextDayButton.addEventListener('click', () => updateDate(1));

            /**
             * Creates and appends a task element to the correct list in the DOM.
             * @param {object} task - The task object { text: string, completed: boolean }.
             * @param {string} quadrantKey - The key for the target quadrant ('iu', 'inu', etc.).
             */
            function addTaskToDOM(task, quadrantKey) {
                const taskItem = document.createElement('li');
                taskItem.className = 'task bg-slate-50 p-3 rounded-lg flex items-center justify-between transition-all duration-300';
                
                const taskContent = document.createElement('span');
                taskContent.textContent = task.text;
                taskContent.className = 'flex-grow pr-4 break-words';
                
                if (task.completed) {
                    taskItem.classList.add('opacity-50');
                    taskContent.classList.add('line-through');
                }
                
                const buttonContainer = document.createElement('div');
                buttonContainer.className = 'flex-shrink-0 flex items-center gap-2';
                
                const doneButton = document.createElement('button');
                doneButton.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-check"><polyline points="20 6 9 17 4 12"></polyline></svg>`;
                doneButton.className = 'btn-done text-green-500 hover:text-white hover:bg-green-500 p-1 rounded-full transition-colors';
                doneButton.setAttribute('aria-label', 'Mark as done');
                doneButton.addEventListener('click', () => {
                    taskItem.classList.toggle('opacity-50');
                    taskContent.classList.toggle('line-through');
                    saveTasksForDate(toYYYYMMDD(currentDate));
                });
                
                const deleteButton = document.createElement('button');
                deleteButton.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>`;
                deleteButton.className = 'btn-delete text-red-500 hover:text-white hover:bg-red-500 p-1 rounded-full transition-colors';
                deleteButton.setAttribute('aria-label', 'Delete task');
                deleteButton.addEventListener('click', () => {
                    taskItem.classList.add('scale-0', 'opacity-0');
                    setTimeout(() => {
                        taskItem.remove();
                        saveTasksForDate(toYYYYMMDD(currentDate));
                    }, 300);
                });

                buttonContainer.append(doneButton, deleteButton);
                taskItem.append(taskContent, buttonContainer);
                quadrantLists[quadrantKey].appendChild(taskItem);
            }

            // --- INITIAL LOAD ---
            renderForDate(currentDate);
        });
    </script>
</body>
</html>
